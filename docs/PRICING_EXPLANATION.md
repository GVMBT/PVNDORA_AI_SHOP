# ะะฑัััะฝะตะฝะธะต ะกัััะบัััั ะฆะตะฝ ะฒ PVNDORA

## ๐ฏ ะัะฝะพะฒะฝัะต ะะพะฝััะธั

### 1. **MSRP (Manufacturer's Suggested Retail Price)**
**ะญัะพ ะพัะธัะธะฐะปัะฝะฐั ัะตะฝะฐ ัะตัะฒะธัะฐ ะพั ะฟัะพะธะทะฒะพะดะธัะตะปั** (Google, OpenAI, etc.)

- **USD**: `products.msrp` (ะฝะฐะฟัะธะผะตั, 250$ ะดะปั Gemini Ultra)
- **RUB**: `products.msrp_prices["RUB"]` (ะฝะฐะฟัะธะผะตั, 20000โฝ ะดะปั Gemini Ultra)
- **ะัะฟะพะปัะทะพะฒะฐะฝะธะต**: ะญัะพ `original_price` ะฒ ะทะฐะบะฐะทะต - ะฟะพะบะฐะทัะฒะฐะตั "ัะบะพะปัะบะพ ััะพะธะปะพ ะฑั ะฑะตะท ะฝะฐั"

### 2. **Price (ะะฐัะฐ ะฆะตะฝะฐ)**
**ะญัะพ ัะตะฝะฐ ะฒ PVNDORA ะฟะพัะปะต ะฝะฐัะธั ัะบะธะดะพะบ**

- **USD**: `products.price` (ะฝะฐะฟัะธะผะตั, 60$ ะดะปั Gemini Ultra)
- **RUB**: `products.prices["RUB"]` (ะฝะฐะฟัะธะผะตั, 4750โฝ ะดะปั Gemini Ultra)
- **ะัะฟะพะปัะทะพะฒะฐะฝะธะต**: ะญัะพ ะฑะฐะทะฐ ะดะปั ัะฐััะตัะฐ `final_price` (ะฟะพัะปะต ะฟัะธะผะตะฝะตะฝะธั ัะบะธะดะพะบ)

### 3. **Final Price (ะัะพะณะพะฒะฐั ะฆะตะฝะฐ)**
**ะญัะพ ัะตะฝะฐ, ะบะพัะพััั ะฟะปะฐัะธั ะฟะพะปัะทะพะฒะฐัะตะปั** (ะฝะฐัะฐ ัะตะฝะฐ ะฟะพัะปะต ะฒัะตั ัะบะธะดะพะบ)

- **USD**: `orders.amount` = `product.price * (1 - discount_percent/100)`
- **RUB**: `orders.fiat_amount` = `product.prices["RUB"] * (1 - discount_percent/100)`

---

## ๐ ะัะธะผะตั: GEMINI ULTRA 45000

### ะ ะะ (products):
```json
{
  "name": "Gemini Ultra 45000 (1 month)",
  "price": 60.0,              // ะะฐัะฐ ัะตะฝะฐ ะฒ USD
  "msrp": 250.0,              // ะัะธัะธะฐะปัะฝะฐั ัะตะฝะฐ Google ะฒ USD
  "prices": {
    "RUB": 4750               // ะะฐัะฐ ัะตะฝะฐ ะฒ RUB (anchor price)
  },
  "msrp_prices": {
    "RUB": 20000              // ะัะธัะธะฐะปัะฝะฐั ัะตะฝะฐ Google ะฒ RUB (anchor MSRP)
  }
}
```

### ะะปั ะฟะพะปัะทะพะฒะฐัะตะปั ะธะท ะะค (RUB):
- **ะัะธะณะธะฝะฐะปัะฝะฐั ัะตะฝะฐ** (`original_price`): 20,000โฝ (MSRP - ัะตะฝะฐ Google)
- **ะะฐัะฐ ัะตะฝะฐ** (`price`): 4,750โฝ (ัะตะฝะฐ PVNDORA)
- **ะัะพะณะพะฒะฐั ัะตะฝะฐ** (`final_price` / `fiat_amount`): 4,750โฝ (ะตัะปะธ ะฝะตั ัะบะธะดะพะบ)
- **ะญะบะพะฝะพะผะธั**: 20,000โฝ - 4,750โฝ = **15,250โฝ** (76% ัะบะธะดะบะฐ)

### ะะปั ะฟะพะปัะทะพะฒะฐัะตะปั ะธะท-ะทะฐ ะณัะฐะฝะธัั (USD):
- **ะัะธะณะธะฝะฐะปัะฝะฐั ัะตะฝะฐ** (`original_price`): $250 (MSRP - ัะตะฝะฐ Google)
- **ะะฐัะฐ ัะตะฝะฐ** (`price`): $60 (ัะตะฝะฐ PVNDORA)
- **ะัะพะณะพะฒะฐั ัะตะฝะฐ** (`final_price` / `amount`): $60 (ะตัะปะธ ะฝะตั ัะบะธะดะพะบ)
- **ะญะบะพะฝะพะผะธั**: $250 - $60 = **$190** (76% ัะบะธะดะบะฐ)

### ะะปั ะฟะพะปัะทะพะฒะฐัะตะปั ั ะดััะณะพะน ะฒะฐะปััะพะน (EUR, etc.):
- **ะัะธะณะธะฝะฐะปัะฝะฐั ัะตะฝะฐ** (`original_price`): ะบะพะฝะฒะตััะธััะตััั ะธะท $250 ะฟะพ ัะตะบััะตะผั ะบัััั
- **ะะฐัะฐ ัะตะฝะฐ** (`price`): ะบะพะฝะฒะตััะธััะตััั ะธะท $60 ะฟะพ ัะตะบััะตะผั ะบัััั
- **ะัะพะณะพะฒะฐั ัะตะฝะฐ** (`final_price`): ะบะพะฝะฒะตััะธััะตััั ะธะท $60 ะฟะพ ัะตะบััะตะผั ะบัััั

---

## ๐ ะะพะปั ะฒ ะะฐะบะฐะทะต (orders)

| ะะพะปะต | ะะฝะฐัะตะฝะธะต | ะัะธะผะตั (RUB) | ะัะธะผะตั (USD) |
|------|----------|--------------|--------------|
| `amount` | ะัะพะณะพะฒะฐั ัะตะฝะฐ ะฒ USD | - | 60$ |
| `original_price` | MSRP ะฒ USD | - | 250$ |
| `fiat_amount` | ะัะพะณะพะฒะฐั ัะตะฝะฐ ะฒ ะฒะฐะปััะต ะฟะพะปัะทะพะฒะฐัะตะปั | 4,750โฝ | 60$ |
| `fiat_currency` | ะะฐะปััะฐ ะฟะพะปัะทะพะฒะฐัะตะปั | RUB | USD |
| `exchange_rate_snapshot` | ะััั ะฝะฐ ะผะพะผะตะฝั ะทะฐะบะฐะทะฐ | 79.08 | 1.0 |

---

## ๐ก ะะปััะตะฒัะต ะะพะผะตะฝัั

1. **`original_price` = MSRP** (ะพัะธัะธะฐะปัะฝะฐั ัะตะฝะฐ ัะตัะฒะธัะฐ)
2. **`amount` = final_price** (ะฝะฐัะฐ ัะตะฝะฐ ะฟะพัะปะต ัะบะธะดะพะบ, ะฒ USD)
3. **`fiat_amount` = final_price** (ะฝะฐัะฐ ัะตะฝะฐ ะฟะพัะปะต ัะบะธะดะพะบ, ะฒ ะฒะฐะปััะต ะฟะพะปัะทะพะฒะฐัะตะปั)
4. **ะญะบะพะฝะพะผะธั = `original_price` - `final_price`**
5. **Anchor prices** ะธัะฟะพะปัะทััััั ะดะปั RUB/USD (ัะธะบัะธัะพะฒะฐะฝะฝัะต ัะตะฝั)
6. **ะะพะฝะฒะตััะฐัะธั** ะธัะฟะพะปัะทัะตััั ะดะปั ะดััะณะธั ะฒะฐะปัั (ะดะธะฝะฐะผะธัะตัะบะฐั)

---

## ๐จ ะะธะทัะฐะปะธะทะฐัะธั

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  MSRP (ะัะธัะธะฐะปัะฝะฐั ัะตะฝะฐ Google)                 โ
โ  USD: $250  โ  RUB: 20,000โฝ                    โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โฌ๏ธ  PVNDORA ะกะะะะะ 76%                         โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  Price (ะะฐัะฐ ัะตะฝะฐ)                              โ
โ  USD: $60   โ  RUB: 4,750โฝ                     โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โฌ๏ธ  ะะะะะะะะขะะะฌะะซะ ะกะะะะะ (ะตัะปะธ ะตััั)          โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  Final Price (ะัะพะณะพะฒะฐั ัะตะฝะฐ ะดะปั ะฟะพะปัะทะพะฒะฐัะตะปั)   โ
โ  USD: $60   โ  RUB: 4,750โฝ                     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

ะญะะะะะะะฏ: $190 (USD) ะธะปะธ 15,250โฝ (RUB)
```

---

## ๐ ะะพะด (ะบะฐะบ ััะพ ัะฐะฑะพัะฐะตั)

### ะัะธ ัะพะทะดะฐะฝะธะธ ะทะฐะบะฐะทะฐ (`payments.py`):

```python
# 1. MSRP (original_price)
product_msrp_usd = product.msrp  # 250$
anchor_msrp_rub = product.msrp_prices["RUB"]  # 20,000โฝ
original_price_usd = product_msrp_usd * quantity
original_price_fiat = anchor_msrp_rub * quantity

# 2. ะะฐัะฐ ัะตะฝะฐ (price)
product_price_usd = product.price  # 60$
anchor_price_rub = product.prices["RUB"]  # 4,750โฝ

# 3. ะัะพะณะพะฒะฐั ัะตะฝะฐ (final_price) = ะฝะฐัะฐ ัะตะฝะฐ - ัะบะธะดะบะธ
discount_multiplier = (1 - discount_percent/100)
final_price_usd = product_price_usd * discount_multiplier  # 60$ * 1.0 = 60$
final_price_fiat = anchor_price_rub * discount_multiplier  # 4,750โฝ * 1.0 = 4,750โฝ

# 4. ะกะพััะฐะฝัะตะผ ะฒ ะทะฐะบะฐะท
order.amount = final_price_usd  # 60$
order.original_price = original_price_usd  # 250$
order.fiat_amount = final_price_fiat  # 4,750โฝ
order.fiat_currency = "RUB"
```

---

## โ FAQ

**Q: ะะพัะตะผั `original_price` = MSRP, ะฐ ะฝะต ะฝะฐัะฐ ัะตะฝะฐ?**  
A: ะะพัะพะผั ััะพ ะผั ะฟะพะบะฐะทัะฒะฐะตะผ ัะบะพะฝะพะผะธั ะฟะพะปัะทะพะฒะฐัะตะปั: "ะะผะตััะพ 20,000โฝ ะฒั ะฟะปะฐัะธัะต 4,750โฝ"

**Q: ะงัะพ ะตัะปะธ MSRP ะฝะต ัะบะฐะทะฐะฝ?**  
A: ะัะฟะพะปัะทัะตััั `product.price` ะบะฐะบ fallback (ะฝะฐัะฐ ัะตะฝะฐ ััะฐะฝะพะฒะธััั "ะพัะธะณะธะฝะฐะปัะฝะพะน")

**Q: ะะฐะบ ะพะฟัะตะดะตะปัะตััั ะฒะฐะปััะฐ ะฟะพะปัะทะพะฒะฐัะตะปั?**  
A: ะะพ `language_code` ะธะท Telegram:
- `ru`, `be`, `kk` โ RUB
- ะััะฐะปัะฝัะต โ USD
- ะขะฐะบะถะต ะผะพะถะฝะพ ะทะฐะดะฐัั ะฒัััะฝัั ัะตัะตะท `preferred_currency`

**Q: ะงัะพ ัะฐะบะพะต anchor prices?**  
A: ะคะธะบัะธัะพะฒะฐะฝะฝัะต ัะตะฝั ะฒ ะบะพะฝะบัะตัะฝะพะน ะฒะฐะปััะต (ะฝะฐะฟัะธะผะตั, 4,750โฝ ะดะปั RUB). ะะฝะธ ะฝะต ะผะตะฝััััั ะฟัะธ ะบะพะปะตะฑะฐะฝะธะธ ะบัััะฐ.

**Q: ะะพะณะดะฐ ะธัะฟะพะปัะทัะตััั ะบะพะฝะฒะตััะฐัะธั ะฒะผะตััะพ anchor prices?**  
A: ะะพะณะดะฐ ั ัะพะฒะฐัะฐ ะฝะตั anchor price ะฒ ะฒะฐะปััะต ะฟะพะปัะทะพะฒะฐัะตะปั (ะฝะฐะฟัะธะผะตั, EUR, GBP, etc.)
